# Исправление проблемы с динамическим контентом

## Проблема
После `npm run build` данные из админки не отображаются на сайте - все статично, хотя в админке данные сохранены.

## Причина
При сборке статических файлов функции загрузки данных (`loadCountries()`, `loadTourTypes()`, `loadTours()`) не были включены в собранные HTML файлы или не вызывались при загрузке страницы.

## Решение

### 1. На сервере выполните:

```bash
cd /var/www/lovi_moment228

# Обновить код
git pull origin main

# Пересобрать статические файлы (ВАЖНО!)
npm run build

# Перезапустить сервер
pm2 restart all
```

### 2. Проверьте, что функции загружаются:

#### Проверка главной страницы:
Откройте консоль браузера (F12) на главной странице и проверьте:
- Должны быть сообщения: `=== Загрузка стран ===`, `=== Загрузка видов туров ===`
- Должны быть запросы к `/api/countries` и `/api/tour-types`

#### Проверка страницы туров:
Откройте `/tour/` и проверьте консоль:
- Должно быть сообщение: `Загружено туров: X`
- Должен быть запрос к `/api/tours`

#### Проверка API напрямую:
- `https://lovimoment-travel.com/api/countries` - должны вернуться страны
- `https://lovimoment-travel.com/api/tour-types` - должны вернуться виды туров
- `https://lovimoment-travel.com/api/tours` - должны вернуться туры

### 3. Если проблема сохраняется:

#### Проверьте логи сервера:
```bash
pm2 logs --lines 50
```

Должны быть логи:
- `[API /api/countries] Найдено активных стран: X`
- `[API /api/tour-types] Найдено видов туров: X`
- `[API /api/tours] Найдено туров: X`

#### Проверьте, что HTML файлы содержат JavaScript:
```bash
grep -r "loadCountries\|loadTourTypes\|loadTours" public/index.html public/tour/index.html
```

Должны найтись функции загрузки данных.

#### Проверьте консоль браузера на ошибки:
- Откройте F12 → Console
- Проверьте, нет ли ошибок 404, 500 или других ошибок JavaScript

### 4. Если ничего не помогает:

Убедитесь, что в админке:
- ✅ Страны активны (стоит галочка "Активна")
- ✅ Виды туров активны
- ✅ Туры активны
- ✅ У стран указаны баннеры и ссылки
- ✅ У туров указаны все необходимые данные

## Важно!

**НЕ удаляйте папку `public/` полностью!** В ней хранятся:
- Загруженные изображения туров (`public/static/images/tours/`)
- Загруженные баннеры стран (`public/static/images/countries/`)
- Админ-панель (`public/admin/`)

`build-static.js` настроен так, чтобы НЕ удалять эти файлы при пересборке.

